/*! nthEverything - v0.1 - 2012-09-05
 *  https://github.com/FWeinb/nthEverything
 *  Copyright (c) 2012 Fabrice Weinberg (http://fabrice.weinberg.me/)
 */
(function(e){e.fn.nthEverything=function(){var t="-nthEvery",n=/\s*(.*?)\s*\{(.*?)\}/g,r=/([^:]+)/g,i=/(\w*)-(\w*)(\((even|odd|[\+-n\d]{1,6})\))?/,s=/(\s*[^ ]+\s*)/g,o=/\s+/,u,a={},f="",l=function(e,t,n,r,i){var s=0,o=+e,u,a,f,l,c,h,p=-1;e==="odd"||e==="even"?(o=e==="odd"?1:2,s=2):/^\d+$/.test(e)?(o=e-i,s=0):(f=/^(\+|-)?\d+/.exec(e),l=/(\+|-)?\d+$/.exec(e),o=l?+l[0]:1,s=f?+f[0]:1,c=f?f.length-1:0,h=l?l.length:0,e.substr(c,e.length-h-c).charAt(0)==="-"&&(s*=-1)),o--;for(a=o;a<r;a+=s){if(a<0||a===p)break;n[a]===undefined?n[a]=t:n[a]+=" "+t,p=a}},c=function(e,t){return'<span class="'+e+'">'+t+"</span>"},h=function(e,t){var n="",r,i;for(r=0;r<e.length;r++)i=e[r],i===undefined?n+=t[r]:n+=c(i,t[r]);return n},p=function(e,t,n){var r=new Array(t),i;for(i=0;i<e.period.length;i++)l(n(e.period[i],t),e.className[i],r,t);return r},d={word:function(e){return e.match(s)},letter:function(e){return e.split("")}},v={first:{word:function(e){return e==="firstword"&&(e="1"),e}},last:{word:function(e,t,n){return e==="lastword"&&(e=""+t.match(s).length),e}},nth:{letter:function(e){return e},word:function(e){return e}}},m=function(t,n,r){var i=r.func,s,o,a,f,c,p;return t.each(function(){if(this.nodeType===1)m(e(this).contents(),n,r);else if(this.nodeType===3){s=d[i](this.nodeValue),o=s.length,a=new Array(o);for(var t=0;t<r.period.length;t++)f=r.className[t],c=r.cat[t],p=r.period[t],l(v[c][i](p,n,o),f,a,o,u);e(this).replaceWith(h(a,s)),u+=o}}),u},g=function(e){var s,o,u=!1,l,c,h,p,d,v,m,g,y,b,w,E,S,x;e=e.replace(/(\/\*([\s\S]*?)\*\/)|(\/\/(.*)$)/gm,"").replace(/\n|\r/g,"");while((s=n.exec(e))!==null){h=s[1].split(","),p=s[2];for(l=0;l<h.length;l++)d=h[l],v=d.match(r),d=v.shift(),m=v.shift(),g=v.length!==0?":"+v.join(":"):"",(o=i.exec(m))!==null?(u=!0,y=o[1],b=o[2],w=o[4]!==undefined?o[4]:y+b,E=d.replace("#","id").replace(".","class"),S=E+b,x=E+y+b+w+t,(c=a[S])!==undefined?(c.className.push(x),c.period.push(w),c.style.push(p),c.pseudo.push(g),c.cat.push(y)):a[S]={element:d,func:b,className:[x],cat:[y],period:[w],style:[p],pseudo:[g]}):u===!0&&(f+=d+"{"+p+"}")}},y=function(){var t,n,r,i;for(t in a){n=a[t],r=n.func,e(n.element).each(function(){var t=e(this);u=0,m(t.contents(),t.text(),n)});for(i=0;i<n.className.length;i++)f+="."+n.className[i]+n.pseudo[i]+"{"+n.style[i]+"}"}e("<style>"+f+"</style>").appendTo("head")};e("link[rel=stylesheet],style").each(function(){e(this).is("link")?e.get(this.href).success(function(e){g(e)}):g(e(this).text())}),y()}})(jQuery),$.fn.nthEverything();